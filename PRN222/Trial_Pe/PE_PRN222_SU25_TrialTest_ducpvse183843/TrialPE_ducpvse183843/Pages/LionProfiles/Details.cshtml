@page
@model TrialPE_ducpvse183843.Pages.LionProfiles.DetailsModel

@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div id="LionProfile" class="card-body">
    <h4>LionProfile</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LionProfile.LionName)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LionProfile.LionName)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LionProfile.Weight)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LionProfile.Weight)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LionProfile.Characteristics)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LionProfile.Characteristics)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LionProfile.Warning)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LionProfile.Warning)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LionProfile.ModifiedDate)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LionProfile.ModifiedDate)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LionProfile.LionType)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LionProfile.LionType.LionTypeId)
        </dd>
    </dl>
</div>
<div id="deletedMessage" class="alert alert-danger d-none mt-2">
     This LionProfile has been deleted in real-time!
</div>
<div>
    <a asp-page="./Edit" asp-route-id="@Model.LionProfile.LionProfileId">Edit</a> |
    <a asp-page="./Index">Back to List</a>
</div>


<script src="/js/signalr/dist/browser/signalr.js"></script>
<script>
    "use strict";

    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/lionHub")
        .configureLogging(signalR.LogLevel.Information)
        .build();

    connection.start()
        .then(() => console.log("Connected to SignalR Hub (Reservation Details Page)"))
        .catch(err => console.error("Connection failed:", err.toString()));

    const currentReservationId = "@Model.LionProfile.LionProfileId";
    connection.on("HubDelete_ILionProfile", function (deletedId) {
        if (deletedId == currentReservationId) {
            console.log("LionProfile deleted :", deletedId);

            document.getElementById("LionProfile").classList.add("d-none");
            const deletedMessage = document.getElementById("deletedMessage");
            deletedMessage.classList.remove("d-none");
        }
    });
</script>